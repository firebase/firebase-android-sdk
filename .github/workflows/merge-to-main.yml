name: Merge to main

on:
  pull_request:
    branches:
      - master
    types:
      - opened
      - labeled
      - unlabeled

jobs:
  pr-message:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
    - uses: mshick/add-pr-comment@v2
      with:
        message: >
          ### 📝 PRs merging into main branch

          **Our main branch should always be in a releasable state**.
          If you are working on a larger change, or if you don't want
          this change to see the light of the day just yet, consider
          using a feature branch first, and only merge into the main
          branch when the code complete and ready to be released.

    - name: Label checker
      if: !contains( github.event.pull_request.labels.*.name, 'main-merge-ack')
      run: exit 1
